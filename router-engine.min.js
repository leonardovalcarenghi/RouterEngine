(function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.RouterEngine=e()})(this,function(){function t(){return this}var e,o,n=[{route:"",callBack:null,root:!1}];return t.prototype.Add=function(t,e){if(t=this._trimSlashes(t),!t)throw"[Add] Não é possível adicionar uma rota vázia.";n.push({route:t,callBack:e})},t.prototype.SetRoot=function(t,o){if(t=this._trimSlashes(t),!t)throw"[SetRoot] Não é possível adicionar uma rota vázia como root.";e=t,this.Add(t,o)},t.prototype.SetListener=function(t,e){t=this._trimSlashes(t);const o=this._getRoute(t);if(!o)throw"[SetListener] Não foi encontrado nenhuma rota definida para essa hash.";o.callBack=e},t.prototype.SetTitle=function(t,e){t=this._trimSlashes(t);const o=n.find(e=>e.route==t);if(!o)throw"[SetTitle] Não foi encontrado nenhuma rota definida para essa hash.";o.title=e||""},t.prototype.NavigateTo=function(t){t=this._trimSlashes(t),window.location.hash=t},t.prototype.SetRenderEngine=function(t){o=t},t.prototype.StartTrigger=async function(){const t=this,o=this._getHash();return o?(await this._renderPage(o),this._setTitle(o),this._callCallback(o),this._callEventListener(o)):(await this._renderPage(o),this._setTitle(o),this._callCallback(e),this._callEventListener(o)),window.onhashchange=async function(){const e=t._getHash();e&&(await t._renderPage(e),t._setTitle(e),t._callCallback(e)),t._callEventListener(e)},this},t.prototype.LoadRoutesFromFile=async function(t){const o=await this._get(t);try{const t=JSON.parse(o);if(!Array.isArray(t))throw"Arquivo JSON não contém uma Array de rotas válida.";{t.forEach(t=>{t.route=this._trimSlashes(t.route)}),n=t;const o=n.find(t=>1==t.root);e=o.route||null}}catch(t){throw t}},t.prototype._getHash=function(){const t=window.location.hash.substr(1).replace(/(\?.*)$/,"");return this._trimSlashes(t)},t.prototype._getRoute=function(t){const e=n.find(e=>e.route==t);return e||null},t.prototype._renderPage=async function(t){const e=this._getRoute(t);o&&await o.Page(e.path)},t.prototype._callCallback=function(t){t=this._trimSlashes(t);const e=n.find(e=>e.route==t);e&&"function"==typeof e.callBack&&e.callBack()},t.prototype._callEventListener=function(t){const e=n.find(e=>e.route==t),o=this._getUrlParams(),i={route:e,hash:t,parameters:o},r=new CustomEvent("routerChange",{detail:i});window.dispatchEvent(r),"function"==typeof window.onRouterChange&&window.onRouterChange(i)},t.prototype._getUrlParams=function(){let t=window.location.href,e=t.indexOf("?");if(-1==e)return null;t=t.substr(e+1,t.length);let o=t.split("&");var n={};return o.forEach(t=>{const e=t.split("=")[0],o=t.split("=")[1];n[e]=o}),n},t.prototype._setTitle=function(t){t=this._trimSlashes(t);const e=n.find(e=>e.route==t);if(e){const t=e.title;document.getElementsByTagName("title")[0].innerHTML=t||""}},t.prototype._trimSlashes=function(t){return"string"!=typeof t?"":t.toString().replace(/\/$/,"").replace(/^\//,"")},t.prototype._get=function(t){return new Promise((e,o)=>{const n=new XMLHttpRequest;n.open("GET",t,!0),n.send(null),n.onload=(()=>{404==n.status?o(null):e(n.responseText)}),n.onerror=(()=>{o(null)})})},t});